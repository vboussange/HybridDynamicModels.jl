<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · HybridDynamicModels.jl</title><meta name="title" content="Home · HybridDynamicModels.jl"/><meta property="og:title" content="Home · HybridDynamicModels.jl"/><meta property="twitter:title" content="Home · HybridDynamicModels.jl"/><meta name="description" content="Documentation for HybridDynamicModels.jl."/><meta property="og:description" content="Documentation for HybridDynamicModels.jl."/><meta property="twitter:description" content="Documentation for HybridDynamicModels.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.svg" alt="HybridDynamicModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>HybridDynamicModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Key-Features"><span>🚀 Key Features</span></a></li><li><a class="tocitem" href="#Installation"><span>📦 Installation</span></a></li><li><a class="tocitem" href="#Quick-Start"><span>🔥 Quick Start</span></a></li><li><a class="tocitem" href="#Documentation"><span>📚 Documentation</span></a></li><li><a class="tocitem" href="#Acknowledgments"><span>🙏 Acknowledgments</span></a></li></ul></li><li><a class="tocitem" href="api/">API</a></li><li><a class="tocitem" href="dev_guide/">-</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/vboussange/HybridDynamicModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/vboussange/HybridDynamicModels.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><table><tr><th style="text-align: center"><strong>Documentation</strong></th><th style="text-align: center"><strong>Build Status</strong></th><th style="text-align: center"><strong>Julia</strong></th><th style="text-align: center"><strong>Testing</strong></th></tr><tr><td style="text-align: center">[![docsstbl][docs-stbl]][docsstbl-url] [![docsdev][docs-dev]][docsdev-url]</td><td style="text-align: center">[![CI][ci-img]][ci-url]</td><td style="text-align: center">[![Julia][julia-img]][julia-url] [![Code Style: Blue][style-img]][style-url]</td><td style="text-align: center">[![Aqua QA][aqua-img]][aqua-url] [![codecov][cc-img]][cc-url]</td></tr></table><p><img src="https://github.com/vboussange/HybridDynamicModels.jl/blob/main/docs/src/assets/logo.svg" alt/></p><h1 id="HybridDynamicModels.jl"><a class="docs-heading-anchor" href="#HybridDynamicModels.jl">HybridDynamicModels.jl</a><a id="HybridDynamicModels.jl-1"></a><a class="docs-heading-anchor-permalink" href="#HybridDynamicModels.jl" title="Permalink"></a></h1><p><em>A comprehensive toolbox for hybrid dynamical modeling combining domain knowledge with machine learning.</em></p><hr/><p><code>HybridDynamicModels.jl</code> provides a unified framework for building, training, and analyzing hybrid dynamical models that seamlessly integrate traditional scientific models with machine learning layers. Built on <code>Lux.jl</code>, it enables both gradient-based optimization and Bayesian inference for uncertainty quantification.</p><h2 id="Key-Features"><a class="docs-heading-anchor" href="#Key-Features">🚀 Key Features</a><a id="Key-Features-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Features" title="Permalink"></a></h2><h3 id="**Dynamical-model-layers**"><a class="docs-heading-anchor" href="#**Dynamical-model-layers**"><strong>Dynamical model layers</strong></a><a id="**Dynamical-model-layers**-1"></a><a class="docs-heading-anchor-permalink" href="#**Dynamical-model-layers**" title="Permalink"></a></h3><ul><li><strong><code>ICLayer</code></strong>: For initial condition inference</li><li><strong><code>ODEModel</code></strong>: Neural ODEs</li><li><strong><code>ARModel</code></strong>: Autoregressive models</li><li><strong><code>AnalyticModel</code></strong>: For explicit dynamical models</li></ul><h3 id="**Utility-layers-for-hybrid-modeling**"><a class="docs-heading-anchor" href="#**Utility-layers-for-hybrid-modeling**"><strong>Utility layers for hybrid modeling</strong></a><a id="**Utility-layers-for-hybrid-modeling**-1"></a><a class="docs-heading-anchor-permalink" href="#**Utility-layers-for-hybrid-modeling**" title="Permalink"></a></h3><ul><li><strong><code>ParameterLayer</code></strong>: Learnable parameters, composable with optional <code>Constraint</code> layers</li><li><strong><code>BayesianLayer</code></strong>: Add probabilistic priors to any Lux layer</li></ul><h3 id="**Data-loaders**"><a class="docs-heading-anchor" href="#**Data-loaders**"><strong>Data loaders</strong></a><a id="**Data-loaders**-1"></a><a class="docs-heading-anchor-permalink" href="#**Data-loaders**" title="Permalink"></a></h3><ul><li><strong><code>SegmentedTimeSeries</code></strong>: Time series data loader with segmentation, implementing mini-batching.</li></ul><h3 id="**Training-API,-with-following-backends**"><a class="docs-heading-anchor" href="#**Training-API,-with-following-backends**"><strong>Training API, with following backends</strong></a><a id="**Training-API,-with-following-backends**-1"></a><a class="docs-heading-anchor-permalink" href="#**Training-API,-with-following-backends**" title="Permalink"></a></h3><ul><li><strong><code>SGDBackend</code></strong>: Fast gradient-based optimization with automatic differentiation</li><li><strong><code>MCSamplingBackend</code></strong>: Full Bayesian inference with uncertainty quantification  </li><li><strong><code>VIBackend</code></strong>: Variational inference for scalable approximate Bayesian methods</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">📦 Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;HybridDynamicModels&quot;)</code></pre><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">🔥 Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><h3 id="Basic-Hybrid-ODE-Model"><a class="docs-heading-anchor" href="#Basic-Hybrid-ODE-Model">Basic Hybrid ODE Model</a><a id="Basic-Hybrid-ODE-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Hybrid-ODE-Model" title="Permalink"></a></h3><pre><code class="language-julia hljs">using HybridDynamicModels
using Lux, OrdinaryDiffEq, Optimisers

# Define hybrid model layers
neural_layer = Chain(Dense(2, 2, tanh), Dense(2, 2))

param_constraint = BoxConstraint([1e-2], [1e0])
param_layer = ParameterLayer(init_value = (growth_rate = [0.1, 0.2]), constraint = param_constraint)

# Hybrid dynamics combining neural network and domain knowledge
function dudt(layers, u, ps, t)
    # Domain-specific term
    domain_params = layers.params(ps.params)
    growth_term = domain_params.growth_rate .* u
    
    # Neural network term  
    neural_term = layers.neural(u, ps.neural)
    
    return growth_term + neural_term
end

# Create the ODE model
model = ODEModel(
    (neural = neural_layer, params = param_layer),
    dudt,
    alg = Tsit5(),
    abstol = 1e-6,
    reltol = 1e-6
)

# Setup training data
data = rand(2, 100)  # Your time series data
dataloader = SegmentedTimeSeries(data; segment_length=20, shift=10)

# Configure training
backend = SGDBackend(
    Adam(1e-3),           # Optimizer
    1000,                 # Number of epochs  
    AutoZygote(),         # AD backend
    MSELoss()            # Loss function
)

# Train the model
result = train(backend, model, dataloader, InferICs(false))
trained_model = result.best_model

# Make predictions
prediction = trained_model((u0 = [1.0, 0.5], tspan = (0.0, 10.0), saveat = 0:0.1:10))</code></pre><h3 id="Bayesian-Parameter-Estimation"><a class="docs-heading-anchor" href="#Bayesian-Parameter-Estimation">Bayesian Parameter Estimation</a><a id="Bayesian-Parameter-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Parameter-Estimation" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Distributions, Turing

# Add Bayesian priors to parameters
param_priors = (growth_rate = product_distribution([Normal(0.1, 0.05), Normal(0.2, 0.05)]),)
bayesian_params = BayesianLayer(param_layer, param_priors)

# Create Bayesian model
bayesian_model = ODEModel(
    (neural = neural_layer, params = bayesian_params),
    dudt,
    alg = Tsit5()
)

# MCMC training for uncertainty quantification
mcmc_backend = MCSamplingBackend(
    NUTS(0.65),          # MCMC sampler
    1000,                # Number of samples
    LogNormal            # Data likelihood
)

# Bayesian training
result = train(mcmc_backend, bayesian_model, dataloader, InferICs(true))
chains = result.chains

# Posterior analysis
posterior_samples = sample(result.st_model, chains, 100)</code></pre><h3 id="Learning-Initial-Conditions"><a class="docs-heading-anchor" href="#Learning-Initial-Conditions">Learning Initial Conditions</a><a id="Learning-Initial-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Learning-Initial-Conditions" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Configure learnable initial conditions with constraints
constraint_u0 = BoxConstraint([1e-3], [5e0])  # Positive initial conditions
infer_ics = InferICs(true, constraint_u0)

# Train with learned initial conditions
result = train(backend, model, dataloader, infer_ics)

# Access learned initial conditions for each segment
for (i, token) in enumerate(tokens(tokenize(dataloader)))
    ic_params = result.best_model.initial_conditions.ics[i]
    println(&quot;Segment $i initial condition: &quot;, ic_params)
end</code></pre><h2 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">📚 Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h2><h3 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h3><p>TO COMPLETE</p><h3 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h3><p>Checkout the API documentation.</p><h2 id="Acknowledgments"><a class="docs-heading-anchor" href="#Acknowledgments">🙏 Acknowledgments</a><a id="Acknowledgments-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgments" title="Permalink"></a></h2><p>Built on the excellent LuxDL, SciML and TuringLang ecosystem, particularly:</p><ul><li><a href="https://github.com/LuxDL/Lux.jl">Lux.jl</a> for neural networks</li><li><a href="https://github.com/TuringLang/Turing.jl">Turing.jl</a> for Bayesian inference</li><li><a href="https://github.com/SciML/SciMLSensitivity.jl">SciMLSensitivity.jl</a> for automatic differentiation</li><li><a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a> for differential equations</li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 20 September 2025 03:45">Saturday 20 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
